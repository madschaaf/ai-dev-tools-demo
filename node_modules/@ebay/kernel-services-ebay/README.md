# kernel-services-ebay 

[![Build Status](https://go/-/nodejsci/job/nodejs/job/kernel-services-ebay/job/master/badge/icon)](https://go/-/nodejsci/job/nodejs/job/kernel-services-ebay/job/master/) [![Dependency Status](https://appvalidator.vip.qa.ebay.com/nodejs/kernel-services-ebay.svg)](https://appvalidator.vip.qa.ebay.com/nodejs/kernel-services-ebay)
[![Code Coverage](https://badgeme.vip.qa.ebay.com/badge/sonar/v0/coverage/kernel-services-ebay)](http://sonar/dashboard/index?id=kernel-services-ebay)


This module provides raptor kernel functionality based on REST API kernel services

## Changelog

See   [CHANGELOG.MD](https://github.corp.ebay.com/nodejs/kernel-services-ebay/blob/master/CHANGELOG.md#changelog)

# Usage

Create service client

```javascript
var kernelServ = require('@ebay/kernel-services-ebay');

```

Querying for site metadata based on host name.

```javascript
// get site info
kernelServ.getSiteInfo('ebay.de', function(err, info) {
    if (err) {
        console.error('Failed to get site info, err: ' + err.stack);
        return;
    }

    console.log('Site id is ' + info['site-id']);
    console.log('Locale is ' + info['locale-info'].language + '-' + info['locale-info'].country);

});
```

Response example:

```
{
    'site-info': {
        'site-id': 101,
        'locale-info': {
            language: 'it',
            country: 'IT',
            variant: ''
        }
    },
    error: {
        message: 'error message',
        stackTrace: {}
    }
}
```

Querying for sign in page link.

```javascript
// get sigin in link
kernelServ.getSignInLink({returnUrl:'http://www.ebay.de', pageId: 4}, function(err, link) {
    if(err) {
      console.error('Failed to get sign in link, err: ' + err.stack);
      return;
    }
    console.log('The link is ' + link);

  });
```

Response example:

```
{
    'sign-in-link' : 'https://signin.de.paradise.qa.ebay.com/ws/eBayISAPI.dll?SignIn&UsingSSL=1&siteid=77&co_partnerId=2&pageType=3&ru=http%3A%2F%2Fwww.ebay.de',
    error: {
        message: 'error message',
        stackTrace: {}
    }
}
```

Querying for currency list

```javascript
// get currency list (it is cached after first call)
kernelServ.getCurrencyList(function(err, list) {
    if (err) {
        console.error('Failed to get currency list, err: ' + err.stack);
        return;
    }
    console.log('The USD currecny code is ' + list['USD'].code);

});

```

Response example:

```
{
    list: {
        USD : {
            symbolPrefix : true,
            code : "USD",
            iso4217DigitCode : 840,
            iso4217DigitCodeString : "840",
            symbol : "$",
            currencyId : 1,
            decimals : 2,
            maxAmount : 99999999,
            name : "USD",
            id : 840,
            value : 840,
            integer : 840
        },
        CAD : {
        }
    },
    error: {
        message: 'error message',
        stackTrace: {}
    }
}
```

# API

 - **getSiteInfo(urlOrHost, callback)** - provides site info for given URL or host name

 - **getSignInLink(options, callback)** - provides sign in page link for the given return url and page id options has the following memebers: returnUrl, pageId, [needsConfirmSignIn, isL2Auth, radarHighRisk].
returnUrl, pageId are required, others are optional.

   - returnUrl (string) is return url to the page after sign in is done
   - pageId (number) is an id of the current page
   - needsConfirmSignIn (boolean) true if user needs to go to signin for confirmation step.
   - isL2Auth (boolean), it true then it is for L2AUTH
   - radarHighRisk (boolean), Signin Session Management - Radar HighRiskFlag for the User if true

 - **getCurrencyList(callback)** - provides a list of currencies metadata.
