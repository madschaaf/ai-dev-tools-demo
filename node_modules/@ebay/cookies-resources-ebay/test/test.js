const fs = require('fs');
const path = require('path');
const Assert = require('assert');

// path: current directory + '../resources/EbayCookiesAndCookielets_metadata.json';
// eslint-disable-next-line no-underscore-dangle
const file = path.join(__dirname, '../resources/EbayCookiesAndCookielets_metadata.json');

describe('EbayCookiesAndCookielets_metadata.json', () => {
    it('should be a valid json"', () => {
        const data = fs.readFileSync(file, 'utf8');
        const parsedData = JSON.parse(data);
        Assert.ok(parsedData);
    });

    // All EbayCookiesAndCookielets_metadata.json ID should have a match in EbayCookiesAndCookielets.json
    it('should have a match in EbayCookiesAndCookielets.json"', () => {
        const data = fs.readFileSync(file, 'utf8');
        const parsedData = JSON.parse(data);

        const cookies = fs.readFileSync(path.join(__dirname, '../resources/EbayCookiesAndCookielets.json'), 'utf8');
        const parsedCookies = JSON.parse(cookies);

        const cookieIds = Object.keys(parsedData.EbayCookies);
        cookieIds.forEach((id) => {
            Assert.ok(parsedCookies.EbayEntities[id]);
        });

        const cookieletIds = Object.keys(parsedData.EbayCookielets);
        cookieletIds.forEach((id) => {
            if (id === 'UNUSED') {
                return;
            }
            Assert.ok(parsedCookies.EbayEntities[id]);
        });
    });
});
