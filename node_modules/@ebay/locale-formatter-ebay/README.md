# locale-formatter-ebay

[![Build Status](https://ebayci.qa.ebay.com/CI-Instance/buildStatus/icon?job=locale-formatter-ebay)](https://ebayci.qa.ebay.com/CI-Instance/job/locale-formatter-ebay)  [![Dependency Status](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/nodejs/locale-formatter-ebay.svg)](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/nodejs/locale-formatter-ebay)  [![Code Coverage](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/coverage/nodejs/locale-formatter-ebay)](http://sonar/dashboard/index?id=locale-formatter-ebay)


Locale based Currency, Number, Date and Time Formatter.
This module is based on the eBay specific Currency deatils list maintained by the 118n team and the LocalizedResources (presentation.properties).

## Changelog

See   [CHANGELOG.MD](https://github.corp.ebay.com/nodejs/locale-formatter-ebay/blob/master/CHANGELOG.md#changelog)

## Usage

```
$ npm install locale-formatter-ebay
```

### API

#### formatMoney

```js
formatMoney(amount, currencyCode, [locale], [options])
```

* `amount` - The amount to be formatted.
* `currencyCode` - The currency code for the Money. This is the 3-letter ISO 4217 Currency code. For example 'USD'
* `[locale]` - The locale string for the current locale. `lang_country` format. For example 'en_US'. This value is optional, if omitted the defaut value would be considered as 'en_US'.
* `[options]` - Additional options (Optional parameters). Passed as an Object.

Options

```js
{
	currencySymbolType : 'standard',
	emitInternalDecimal: false,
	decimal: 4 // << it is 2 by default and this should be only used for exchange rate where it needs to show more digits for conversion rate.
}
```

* `currencySymbolType` -  The Currency symbol type for the formatter. Following are the options.

`standard` - 'US $'

`simple` -  '$'

`fancy` -  '<font size=\"-1\" color=\"#666666\">US</font> $'

`symbol` -  '$' - will try to use world currency symbol (â‚¬) or fallback to simple format (EUR)

Default values is `standard`.

* `emitInternalDecimal` - The boolean property to control the type of emission to decide whether to display internal decimal value or not. Default is `false`.


##### Response

The response of the formatMoney is an Object of the Following format.

```js
{
    format: "<formatString>", //For example `US $50.55`
    currencySymbol: "<currencySymbol>", // For example `US $`
    error: null	// Error message if any. Default value is null.
}
```

##### Examples

```js
var formatter = require('@ebay/locale-formatter-ebay');

var resp = formatter.formatMoney(25.5, 'USD');
console.log("Format for USD 25.5 : ", resp);
//OUTPUT
//Format for USD 25.5 : { format : 'US $25.50', currencySymbol: 'US $', error : null }

resp = formatter.formatMoney(2345.6545, "USD", "en_US");
console.log("Format for USD 2345.6545 : ", resp);
//OUTPUT
//Format for USD 2345.6545 : { format : 'US $2,345.65', currencySymbol: 'US $', error : null }


resp = formatter.formatMoney(2345.6545, "USD", "en_US", {
	currencySymbolType : 'simple'
});
console.log("Format for USD 2345.6545 : ", resp);
//OUTPUT
//Format for USD 2345.6545 : { format : '$2,345.65', currencySymbol: '$', error : null }


resp = formatter.formatMoney(-.65456766, "USD", "en_US", {
	currencySymbolType : 'simple'
});
console.log("Format for USD -.65456766 : ", resp);
//OUTPUT
//Format for USD 2345.6545 : { format : '-$0.65', currencySymbol: '$', error : null }

```

##### Error scenarios

`Undefined amount`

`Non numeric amount value`

`Amount is greater than the Safe Integer Limit for Money related Operations`

`Undefined currency`

`Invalid Currency`

`Amount is greater than the Max value for the currency`

`Currency format is not found for the currency code`


#### formatDateTime

```js
formatDateTime(date, [locale], [options])
```

* `date` - The JavaScripts date to be formatted. This can be a `date` object OR a valid date string in ISO-8601 format that can be parsed to date using `date.parse`.

* `[locale]` - The locale string for the current locale. `lang_country` format. For example 'en_US'. This value is optional, if omitted the defaut value would be considered as 'en_US'.

* `[options]` - Additional options (Optional parameters). Passed as an Object.

Options

```js
{
	dateTimeOutput  : 'both',
	dateFormatType : 'medium',
	timeFormatType : 'long',
	timeZone: 'America/Los_Angeles'
}
```

* `dateTimeOutput` -  The option to control the format. Following are the options.

`dateonly` - Find format for date section only

`timeonly` -  Find format for time section only

`both` -  Format for both date and time

Default value is `both`.

* `dateFormatType` - The format type used for date to string conversion. Following are the options.
`short`, `medium`, `numeric`, `numericnoday`, `mediumnoday`, `full`, `fullcomplete`, `fullnoyear`, `long`.
Default value is `medium`.

* `timeFormatType` - The format type used for time to string conversion. Following are the options.
`short`, `shortampm`, `shortzone`, `shortampmzone`, `medium`, `long`, `longampm`.
Default value is `long`.

* `timeZone` - Convert date time based on request time zone.
Examples: `Europe/London`, `America/Los_Angeles`, `America/Los_Angeles`.
Default value null. Will use moment.js default value

##### Response

The response of the formatDateTime is an Object of the Following format.

```js
{
	dateFormat 	: "<formatString>", //For example `03/09/14`
	timeFormat 	: "<formatString>", //For example `01:33:55`
	error	: null	// Error message if any. Default value is null.
}
```

##### Examples

```js
var formatter = require('@ebay/locale-formatter-ebay');

var date = new Date();
var resp  = formatter.formatDateTime(date);
console.log("en_US locale Medium Date time format for ", date, " : ", resp);
	// OUTPUT
	// en_US locale Medium Date time format for  Wed Sep 03 2014 01:33:55 GMT-0700 (PDT)  :  { dateFormat: 'Sep-03-14', timeFormat: '01:33:55 ', error: null }

resp  = formatter.formatDateTime(date, "en_US", { dateFormatType : "short" });
console.log("en_US locale Short Date time format for ", date, " : ", resp);
	// OUTPUT
	// en_US locale Short Date time format for  Wed Sep 03 2014 01:33:55 GMT-0700 (PDT)  :  { dateFormat: 'Sep-03', timeFormat: '01:33:55 ', error: null }


resp  = formatter.formatDateTime(date, "fr_CA", { dateFormatType : "numeric" });
console.log("fr_CA locale Numeric Date time format for ", date, " : ", resp);
	// OUTPUT
	// fr_CA locale Numeric Date time format for  Wed Sep 03 2014 01:33:55 GMT-0700 (PDT)  :  { dateFormat: '03/09/14', timeFormat: '01:33:55 ', error: null }

// How to get timeZone from request context
var timeZone = req.ebay.getUserCulturalPrefContext().getTimezone();


resp  = formatter.formatDateTime(date, "en_US", { dateFormatType : "short", timeZone: 'America/Los_Angeles'});
console.log("en_US locale Short Date time format with America/Los_Angeles time zone", date, " : ", resp);
	// OUTPUT
	// en_US locale Short Date time format with America/Los_Angeles time zone Wed Nov 18 2015 08:57:54 GMT-0800 (PST)  :  { dateFormat: 'Nov-18', timeFormat: '08:57:54 PST', error: null }

resp  = formatter.formatDateTime(date, "en_GB", { dateFormatType : "short", timeZone: 'Europe/London'});
console.log("en_GB locale Short Date time format with Europe/London time zone", date, " : ", resp);
	// OUTPUT
	// en_GB locale Short Date time format with Europe/London time zone Wed Nov 18 2015 08:57:54 GMT-0800 (PST)  :  { dateFormat: '18-Nov', timeFormat: '16:57:54 GMT', error: null }

```

##### Error scenarios

`Undefined date`

`Invaid date`

`Invalid date format type`

`Invalid time format type`

`Invalid time zone`

#### formatNumber

```js
formatNumber(number, [locale], [options])
```

* `number` - Any valid number, may also be in the form of a string.

* `[locale]` - The locale string for the current locale. `lang_country` format. For example 'en_US'. This value is optional, if omitted the defaut value would be considered as 'en_US'.

* `[options]` - Additional options (Optional parameters). Passed as an Object.

Options

```js
{
	fractionDigits: 2
}
```

##### Response

The response of the formatNumber is an Object of the Following format.

```js
{
	format 		: "<formatString>", //For example `15,378`
	error	: null	// Error message if any. Default value is null.
}
```

##### Examples

```js
var formatter = require('@ebay/locale-formatter-ebay');

var number = 15378;
var resp  = formatter.formatNumber(number));
console.log("en_US locale number format for ", number, " : ", resp);
	//OUTPUT
	//en_US locale locale number format for 15378  :  { format: '15,378', error: null }

resp  = formatter.formatNumber('15379.356'));
console.log("en_US locale number format for ", number, " : ", resp);
	//OUTPUT
	//en_US locale locale number format for 15379.356  :  { format: '15,379.356', error: null }

resp  = formatter.formatNumber(number, "fr_FR");
console.log("fr_FR locale number format for ", number, " : ", resp);
	//OUTPUT
	//fr_FR locale number format for 15378  :  { format: '15.378', error: null }

resp = formatter.formatNumber(123.456789, "fr_FR", { fractionDigits: 2 })
	// --> 123,45
```

##### Error scenarios

`Invalid number`

`Undefined number`
