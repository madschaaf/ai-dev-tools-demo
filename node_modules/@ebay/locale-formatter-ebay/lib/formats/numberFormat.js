"use strict";

var formatsReader = require('../reader/formatsReader'),
	Cache = require('lru-backup-cache'),
	numFormCache = new Cache({
		"enabled": true,
		"max": 20000          //Cache size
	});

function NumberFormat (locale, options) {
	locale = locale && locale.replace('-', '_');
	this._locale = locale;
	this._formats = formatsReader.load(locale);
	this._decimalChar = this._formats && this._formats.getDecimalChar();
	this._groupingChar = this._formats && this._formats.getGroupingChar();
}

NumberFormat.prototype = {
	getLocale : function () {
		return this._locale;
	},
	getDecimalChar : function () {
		return this._decimalChar;
	},
	getGroupingChar : function () {
		return this._groupingChar;
	}
};

function getFormat(locale) {
	// TODO Check for locale null condition
	var format = numFormCache.get(locale);
	if (!format) {
		format = new NumberFormat(locale);
		numFormCache.set(locale, format);

	}
	return format;
}

exports = module.exports = getFormat;
