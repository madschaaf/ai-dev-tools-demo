# common-types-ebay

The module defines common types user specific to ebay platform that can be used at server side rendering.

The client side rendering is not recommended as the size of the enums is too big.
One must provide already converted values to client side via Ajax or configuration.

## Install

```bash
$ npm install common-types-ebay -S
# or
$ yarn add common-types-ebay
```

## Usage

## Enum API

### Enum.define(values)

Defines enum based of given values and prevent further modification of the result object.

```js
const Enum = require('@ebay/common-types-ebay/enum');
const COUNT = Enum.define('ONE', 'TWO');
console.log(COUNT.ONE); // print ONE
console.log(COUNT.TWO); // print TWO
```

More advanced use case

```js
const Enum = require('@ebay/common-types-ebay/enum');
const COUNT = Enum.define({
    ONE: {
        foo: 'fooVal'
    },
    TWO: {
        bar: 'barVal'
    }
});
console.log(COUNT.ONE.value); // print {foo: 'fooVal'}
console.log(COUNT.TWO.value); // print {bar: 'barVal'}
```

### valueOf()

Resolves enum value based on its string representation.

```js
const Enum = require('@ebay/common-types-ebay/enum');
const COUNT = Enum.define('ONE', 'TWO');
Assert.equal(COUNT.ONE, COUNT.valueOf('ONE'));
```

### values()

Returns all the values of enum

```js
const Enum = require('@ebay/common-types-ebay/enum');
const COUNT = Enum.define('ONE', 'TWO');
COUNT.values.forEach(value => {
    console.log(value);
}); // will print ONE, TWO
```

## Money API

### Money.valueOf(number, currency)

Creates a Money object
```js
const Money = require('@ebay/common-types-ebay/money');
const amount = Money.valueOf(100, 'USD'); // will implicitly convert to Currency enum type
// Or
const Currencies = require('@ebay/common-types-ebay/currency').Currencies;
const amount = Money.valueOf(100, Currencies.USD);
```

Money operations

The operations are immutable.
The result of any operation is a new Money object.


### add(amount)

Adds an amount to the existing money object and returns a new value

**param** is a Money or number amount

**returns** a new Money object

```js
const Money = require('@ebay/common-types-ebay/money');
const amount = Money.valueOf(100, 'USD');
// add
amount.add(Money.valueOf(200, 'USD')); // >> Money.valueOf(300, 'USD');
```

### subtract(amount)

Subtracts an amount to the existing money object and returns a new value

**param** is a Money or number amount

**returns** a new Money object

```js
const Money = require('@ebay/common-types-ebay/money');
const amount = Money.valueOf(100, 'USD');
// subtract
amount.subtract(Money.valueOf(200, 'USD')); // >> Money.valueOf(-100, 'USD');
```

### multiply(amount)

Multiplies the existing money object by a given fraction and returns a new value

**param** is a number amount

**returns** a new Money object

```js
const Money = require('@ebay/common-types-ebay/money');
const amount = Money.valueOf(100, 'USD');
// subtract
amount.multiply(2); // >> Money.valueOf(200, 'USD');
```

### divide(amount)

Divides the existing money object by a given fraction

**param** is a number amount

**returns** a new Money object

```js
const Money = require('@ebay/common-types-ebay/money');
const amount = Money.valueOf(100, 'USD');
// subtract
amount.divide(2); // >> Money.valueOf(50, 'USD');
```

### absolute()

Returns absolute value of money object

```js
const Money = require('@ebay/common-types-ebay/money');
const amount = Money.valueOf(-100, 'USD');
amount.absolute(); // Money.valueOf(100, 'USD');
```

### negate()

Negates the value of the money object

```js
const Money = require('@ebay/common-types-ebay/money');
const amount = Money.valueOf(-100, 'USD');
amount.negate(); // Money.valueOf(100, 'USD');
```

### doubleValue()

Returns the value of the money object

```js
const Money = require('@ebay/common-types-ebay/money');
const amount = Money.valueOf(100.34, 'USD');
amount.negate(); // >> 100.34
```
### isZero()

Returns 0 if the amount === 0

### isPositive()

Returns true if the amount >= 0

### isNegative()

Returns true is the amount is < 0

### getCurrencySymbol()

Returns currency symbol

```js
const Money = require('@ebay/common-types-ebay/money');
console.log(Money.valueOf(100, 'USD').getCurrencySymbol()); // prints $
```

### convert(toCurrency, [when])

Converts to the given currency with exchange rate for the time specified by `when` parameter. By default when will be equal Date.now().

This operation requires a setup of exchange server source which is done by platform via brogan-ebay.

It has a dependency on [kernel-services-ebay](https://github.corp.ebay.com/nodejs/kernel-services-ebay) module that provides exchange rate for the given currencies.

```js
const Money = require('@ebay/common-types-ebay/money');
Money.valueOf(100, 'USD')
    .convert('EUR', Date.now())
    .then(amount => {
        console.log(amount.doubleValue());
    })
    .catch(err => console.log('Failed to convert'));
```
