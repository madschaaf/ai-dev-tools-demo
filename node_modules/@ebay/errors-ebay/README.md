# errors-ebay

[![Build Status](https://ci.altus.vip.ebay.com/ebaykrakn-4389/buildStatus/icon?job=errors-ebay)](https://ci.altus.vip.ebay.com/ebaykrakn-4389/job/errors-ebay) [![Dependency Status](https://appvalidator.vip.qa.ebay.com/nodejs/errors-ebay.svg)](https://appvalidator.vip.qa.ebay.com/nodejs/errors-ebay)
[![Code Coverage](https://badgeme.vip.qa.ebay.com/badge/sonar/v0/coverage/errors-ebay)](http://sonar/dashboard/index?id=errors-ebay)


Error Handling Module include Updating Restarts file, sending email etc

## Changelog

See   [CHANGELOG.MD](https://github.corp.ebay.com/nodejs/errors-ebay/blob/master/CHANGELOG.md#changelog)

# Installation

`npm install errors-ebay --save`

# Usage

```javascript
var errors = require('@ebay/errors-ebay');

```

# API

## Restarts
API for updating error stack, increment Restarts counter, sending email & finally flushing to restart log file.

Usage :
```javascript
var Restart = require('@ebay/errors-ebay').getRestartLog();
Restart.incrementRestarts()
        .setError('Some Error')
        .sendEmail({to: 'mdathrika@ebay.com'})
        .execute(function(err, emailInfo){
            //
        });

```

## Error type

Extends error object to accommodate error properties used at ebay.

```js
const RuntimeError = require('@ebay/errors-ebay/error').RuntimeError;

throw new RuntimeError({
    error: <Error object to wrap>,
    error-id: <number>
    domain: <application domain>
    category: <'APPLICATION' | 'SYSTEM' | 'USER'>
    message: 'error message',
    longMessage: 'error message with more details',
    type: <error type, ex.: bad-token>
    code: <error code, number>
    statusCode: <response status if it is related to http request>
})
```

The parameters are optional and have defaults.

More examples:

```js
const RuntimeError = require('@ebay/errors-ebay/errors').RuntimeError;

try {
    throw new Error('BOOM');
}
catch (err) {
    throw new RuntimeError('More specific error', err);
    // or
    throw new RuntimeError(err); // but meaningless
    // or better
    throw new RuntimeError(err, {
        type: 'WRONG_FORMAT',
        category: 'USER'
    });
}
```
