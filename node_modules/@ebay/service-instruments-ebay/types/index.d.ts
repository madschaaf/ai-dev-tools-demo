import { Request, Response } from 'express';

declare global {
    namespace ServiceInstruments {
        // These open interfaces may be extended in an application-specific manner via declaration merging.
        // See for example method-override.d.ts (https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/method-override/index.d.ts)
        interface ContextualClient {
            // will be filled by extensions via client APIs
        }
    }
}

export interface Context {
    app?: {
        request: Request,
        response: Response
    };
}

export interface SharableClient {
    webContext(webRequest: Request): ServiceInstruments.ContextualClient;
    context(context: Context): ServiceInstruments.ContextualClient;
}

export function use(ownerModule: string): {
    createClient(clientId: string, apiName?: string): Promise<SharableClient>;
};
