# fidelius-client-ebay

[![Build Status](https://ci.altus.vip.ebay.com/ndash-1740/buildStatus/icon?job=nodejs/fidelius-client-ebay/master)](https://ci.altus.vip.ebay.com/ndash-1740/job/nodejs/job/fidelius-client-ebay/job/master/) [![Dependency Status](https://appvalidator.vip.qa.ebay.com/nodejs/fidelius-client-ebay.svg)](https://appvalidator.vip.qa.ebay.com/nodejs/fidelius-client-ebay)
[![Code Coverage](https://badgeme.vip.qa.ebay.com/badge/sonar/v0/coverage/fidelius-client-ebay)](http://sonar/dashboard/index?id=fidelius-client-ebay)


`@ebay/fidelius-client-ebay` is Node.js client for reading secrets from Fidelius and manage access control lists.

Learn more about migration to [Fidelius](https://wiki.vip.corp.ebay.com/display/PLATSEC/Fidelius+-+Introduction) and supported use-cases.

Please refer to [Fidelius API Document](https://pages.github.corp.ebay.com/security-platform/fidelius/) for request and response models

## Changelog

See   [CHANGELOG.MD](https://github.corp.ebay.com/nodejs/fidelius-client-ebay/blob/master/CHANGELOG.md#changelog)

# Installation

`npm install fidelius-client-ebay --save`

# Usage

```javascript
    var fidelius = require('@ebay/fidelius-client-ebay');

```

# API

## setAclNode(pathToSecret, permissions, headers, callback)
* **pathToSecret**: Path where secret is to be stored or updated in Fidelius. e.g `<appName>/path/to/object`
* **permissions**: permission list to be granted access to
* **headers**: Additional Headers that needs to be send to Fidelius
* **callback(error, saveResponse)**: Callback will be called with the response from the save call and returns error when path not found or some internal error.

```javascript
    var fidelius = require('@ebay/fidelius-client-ebay');

    fidelius.setAclNode('<appName>/path/to/object', '<permissions>' {headerKey: header:Value}, (error, saveResponse) => {
        console.log(saveResponse);
    });
```


## getAclNode(pathToSecret, headers, callback)
* **pathToSecret**: Path where secret is to be stored or updated in Fidelius. e.g `<appName>/path/to/object`
* **headers**: Additional Headers that needs to be send to Fidelius
* **callback(error, saveResponse)**: Callback will be called with the response from the save call and returns error when path not found or some internal error.

```javascript
    var fidelius = require('@ebay/fidelius-client-ebay');

    fidelius.getAclNode('<appName>/path/to/object', {headerKey: header:Value}, (error, saveResponse) => {
        console.log(saveResponse);
    });
```


## setSecret(pathToSecret, value, headers, callback)
* **pathToSecret**: Path where secret is to be stored or updated in Fidelius. e.g `<appName>/path/to/object`
* **value**: Value to store
* **headers**: Additional Headers that needs to be send to Fidelius
* **callback(error, saveResponse)**: Callback will be called with the response from the save call and returns error when path not found or some internal error.

```javascript
    var fidelius = require('@ebay/fidelius-client-ebay');

    fidelius.setSecret('<appName>/path/to/object', '<secret>' {headerKey: header:Value}, (error, saveResponse) => {
        console.log(saveResponse);
    });
```


## getSecret(pathToSecret, headers, callback)
* **pathToSecret**: Path where secret is stored in Fidelius. e.g `<appName>/path/to/object`
* **headers**: Additional Headers that needs to be send to Fidelius
* **callback(error, secretValue)**: Callback will be called with the secret Value and returns error when path not found or some internal error.

```javascript
    var fidelius = require('@ebay/fidelius-client-ebay');

    fidelius.getSecret('<appName>/path/to/object', {headerKey: header:Value}, (error, value) => {
        console.log(value);
    });
```

## deleteSecret(pathToSecret, headers, callback)
* **pathToSecret**: Path where secret is stored in Fidelius. e.g `<appName>/path/to/object`
* **headers**: Additional Headers that needs to be send to Fidelius
* **callback(error, deleteResponse)**: Callback will be called with the response from the delete call and returns error when path not found or some internal error.

```javascript
    var fidelius = require('@ebay/fidelius-client-ebay');

    fidelius.deleteSecret('<appName>/path/to/object', {headerKey: header:Value}, (error, deleteResponse) => {
        console.log(deleteResponse);
    });
```


## isAppWhiteListed(appName, callback)
* **appName**: App Name to check for whitelist in Fidelius. e.g `srpnweb`
* **callback(error, enabled)**: Callback will be called with the whitelist status(`true` or `false`) and returns error when service call fails and sets `enabled` to `false`.

```javascript
    var fidelius = require('@ebay/fidelius-client-ebay');

    fidelius.isAppWhiteListed('srpnweb', (error, isEnabled) => {
        console.log(isEnabled);
    });
```

