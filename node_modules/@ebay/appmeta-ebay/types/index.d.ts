// Minimum TypeScript Version: 4.4
export interface ParametersMap {
    parameters: {
        [key: string]: any
    };
}

export interface Page {
    description: string;
    id: string;
    isAjax: boolean;
    isDefault: boolean;
    lifecycleState: string;
    name: string;
    state: string;
    'parameters-Map': ParametersMap;
}

export interface PageMap {
    page: Page[];
}

export interface AppMeta {
    description: string;
    id: string;
    lifecycleState: string;
    name: string;
    secureService: 'true' | 'false';
    state: string;
    type: string;
    version: string;
    'page-Map': PageMap;
    'parameters-Map': ParametersMap;

    getPageId(pageName: string): string | null;

    getPageMeta(pageName: string): Page;

    needIAFToken(pageName: string): boolean;

    getConsumerId(): string;

    getAppSecret(): string;

    setAppSecret(secret: string): void;

    getEbayAppId(): string;

    getEbayCertId(): string;

    getEbayDevId(): string;

    isSecretEncodedOnly: boolean;
}

export namespace AppMeta {
    function serialize(appMeta: AppMeta): string;
    function deserialize(reader: any): Promise<AppMeta>;
    const NO_CHANNEL_FOUND = 'NO_CHANNEL_FOUND';
    const NO_CHANNEL_ACCESS = 'NO_CHANNEL_ACCESS';
}

/**
 * Loads application metadata
 * @param appName is application name
 * @param skipAppSecret flag to skip loading secret if true for optimization purposes when secret is not required, for example when loading some other app metadata
 * @param callback function with error or appMeta
 */
export function getAppMeta(appName: string, skipAppSecret: boolean, callback: (err: Error, appMeta: AppMeta) => void): void;

/**
 * Loads application metadata and application secret. Note that it can only load secret of the current application.
 * @param appName is application name
 * @param callback function with error or appMeta
 */
export function getAppMeta(appName: string, callback: (err: Error, appMeta: AppMeta) => void): void;

/**
 * Loads application metadata similar to getAppMeta and does assertion of required parameters.
 * @param appName is application name
 * @param skipAppSecret flag to skip loading secret if true for optimization purposes when secret is not required, for example when loading some other app metadata
 * @param callback function with error or appMeta
 */
export function load(appName: string, skipAppSecret: boolean, callback: (err: Error, appMeta: AppMeta) => void): void;

/**
 * Loads application metadata similar to getAppMeta and does assertion of required parameters.
 * @param appName is application name
 * @param callback function with error or appMeta
 */
export function loadWithtoutAppSecret(appName: string, callback: (err: Error, appMeta: AppMeta) => void): void;

export interface Context {
    appName: string;
    [x: string | symbol]: any;
}
/**
 * Loads application metadata and application secret. Note that it can only load secret of the current application.
 * @param ctx with appName property
 * @param callback that returns error or app metadata
 */
export function init(ctx: Context, callback: (err: Error, appMeta: AppMeta) => void): void;
