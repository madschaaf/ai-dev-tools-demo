# pipeline-metrics-ebay

This repository aims to have an application to calculate the elapsed time it take to run the request.

It contains a middlewares i.e. `starttime` and `stoptime` which we are using it for calculating the elapsed time to execute the request.

## Integrate

Integrate the above middleware in the `brogan-ebay/config/config.json` repository under the `middleware` file as follows:

```sh
"starttime": {
    "enabled": true,
    "priority": 1,
    "module": {
        "name": "@ebay/pipeline-metrics-ebay/middleware/starttime"
    }
}

"stoptime": {
    "enabled": true,
    "priority": 999,
    "module": {
        "name": "@ebay/pipeline-metrics-ebay/middleware/stoptime"
    }
}
```

## Adding new platform metrics

Added new platform metrics to show the calculated elapsed time on the prometheus platform as follows:

```sh
// this metrics will be available at <hostname>:8083/admin/prometheus/platform
# HELP api_calls_elapsed_time Time taken to execute the API request in ms
# TYPE api_calls_elapsed_time gauge
api_calls_elapsed_time{method="GET",status="200",_namespace_="platform",processId="0"} 2893
```
