'use strict';

const AppContext = require('@ebay/commons-ebay/lib/app-context');
const AppMeta = require('@ebay/appmeta-ebay');
const appContext = require('@ebay/app-context-ebay');

let credentials;

module.exports.getConfig = function getConfig() {
    if (credentials) {
        return Promise.resolve(credentials);
    }

    return new Promise((resolve, reject) => {
        AppMeta.get(AppContext.appName, false, (err, meta) => {
            if (err) {
                return reject(err);
            }

            credentials = {
                domain: 'EBAYAPP',
                consumerId: appContext.consumerId,
                secret: meta.getAppSecret()
            };

            resolve(credentials);
        });
    });
};
module.exports.removeCachedConfig = function () {
    credentials = null;
};
