import { expectType, expectError } from 'tsd';
import type { Request, Response, NextFunction } from 'express';
import { getDeviceInfo, middleware, DeviceInfo } from '.';

(req: Request) => {
  expectType<DeviceInfo>(req.deviceInfo);
};

expectType<(req: Request, res: Response, next: NextFunction) => void>(middleware());

expectType<void>(getDeviceInfo('Chrome 666', (error, response) => {
  expectType<Error | null>(error);
  expectType<DeviceInfo>(response);

  expectType<string>(response.browser);
  expectType<string>(response.browserVersion);
  expectType<string>(response.cpu);
  expectType<string>(response.memory);
  expectType<string>(response.deviceOS);
  expectType<string>(response.osName);
  expectType<string>(response.osVersion);

  expectType<number>(response.displayHeight);
  expectType<number>(response.displayWidth);
  expectType<number>(response.screenHeight);
  expectType<number>(response.screenWidth);

  expectType<boolean>(response.isCookie);
  expectType<boolean>(response.isDesktop);
  expectType<boolean>(response.isHTTPS);
  expectType<boolean>(response.isJS);
  expectType<boolean>(response.isLocalStorage);
  expectType<boolean>(response.isSessionStorage);
  expectType<boolean>(response.isSvg);
  expectType<boolean>(response.isMobile);
  expectType<boolean>(response.isTablet);
  expectType<boolean>(response.isTouchScreen);
  expectType<boolean>(response.isFSOM);
  expectType<boolean>(response.isWebSockets);
  expectType<boolean>(response.isSmall);
  expectType<boolean>(response.isLarge);
  expectType<boolean>(response.isNative);
  expectType<boolean>(response.requestIsWebView);
}));

expectError(getDeviceInfo());

expectError(getDeviceInfo(null, () => {}));

expectError(getDeviceInfo('Firefox 999'));
