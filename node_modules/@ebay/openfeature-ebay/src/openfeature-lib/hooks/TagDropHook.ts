import {
    EvaluationContext,
    Hook,
    HookContext,
    HookHints,
} from '@openfeature/js-sdk';

/**
 * Add tag dropping configuration to Feature Flag request. By default epsvc
 * will drop the tag, so this should be used to disable tag drop.
 * dropTag:false
 */
export default class TagDropHook implements Hook {
    before(hookContext: HookContext, hookHints: HookHints): EvaluationContext {
        let evalContext: EvaluationContext = hookContext.context;
        Object.entries(hookHints).forEach(([key, value]) => {
            if (typeof value === 'boolean' && key === 'dropTag') {
                evalContext[key] = value;
            }
        });
        return evalContext;
    }
}
