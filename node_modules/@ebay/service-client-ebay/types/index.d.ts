// Definitions by: Timur Manyanov <https://github.corp.ebay.com/tmanyanov>
// Definitions: https://github.corp.ebay.com/TypeScript/types-ebay
// TypeScript Version: 3.0

import { Request } from 'express';

export interface AnyMap {
    [key: string]: any;
}

export interface ResponseData {
    body: any;
    statusCode: number;
    headers: AnyMap;
}

export type Callback<TResponse = ResponseData> = (err: Error | null, res: TResponse | undefined) => void;

export type Context = AnyMap & {
    getClient(id: string): RequestClient & GetClient & PostClient & PutClient & DeleteClient & PatchClient;
};

export interface Header {
    build(): Client;
}

export interface GetClient {
    get(queryString?: AnyMap): Client;
}
export type PostPutParams = AnyMap & {
    body?: string;
    qs?: AnyMap;
    path?: string;
};
export interface PostClient {
    post(params?: PostPutParams): Client;
}
export interface PutClient {
    put(params?: PostPutParams): Client;
}
export interface DeleteClient {
    delete(path: string): Client;
}
export interface PatchClient {
    patch(params?: PostPutParams): Client;
}
export interface RequestClient {
    request(req: AnyMap): Client;
    request(req: AnyMap, callback: Callback): void;
}
export interface Client {
    set(header: string, value?: string): Client & Header;
    path(path: string, params?: AnyMap): Client;
    options(options: AnyMap): Client;
    end(callback: Callback): void;
    endAsAsync(): Promise<ResponseData>;
    headers(header: AnyMap): Client;
}

export function context(req: Request | {}): Context;
export type ContextOptions = AnyMap & {
    oauth?: AnyMap;
    tracking?: boolean;
};

export type ContextCallback = (err: Error | null, context?: Context) => void;

export function setupContext(options: ContextOptions, callback: ContextCallback): void;

export {};
