# ChangeLog
## v5.12.2
NODE-5312: NodeJS: Enhance the VI CAL logging to include corr id, https://jirap.corp.ebay.com/browse/NODE-5312

## v5.12.0
NODE-4518: Added new prometheus metrics for HTTPS VI `vi_requests_total` under `/admin/prometheus/platform`

## v5.11.0
NODE-4929: HTTPS VI - Allow port argument for prometheus metrics

## v5.10.26
NODE-4746: IP address shown in ValidateInternals page is not correct for feature workloads, https://jirap.corp.ebay.com/browse/NODE-4746

## v5.10.25
NODE-4994: Fix unexpected port redirect

## v5.10.24
NODE-4856: nodejs - support port and protocol override in portFilter over env variable #202

## v5.10.23
NODE-4634: Support logging VI page update operation to CAL for nodeJS pools, https://jirap.corp.ebay.com/browse/NODE-4634

## v5.10.19
Revert - ACL check for Remote Heap Dumping on start true

## v5.10.18
Revert - ACL check for Remote Heap Dumping on start true

## v5.10.17
ACL check for Remote Heap Dumping on start true

## v5.10.16
NODE-4812: XSS in NodeJS Validate Internals Page

## v5.10.15
NODE-4815: Remote Heap Dumping in NodeJS Validate Internals Page

## v5.10.15
NODE-4813: Enhance TF Validate to Allow Montage Tool

## v5.10.14
NODE-4810: Validate internals needs to pull latest hystrix-dashboard to lazy load rxjs

## v5.10.13
NODE-4789: Fix the traffic mirror for CPDLC NodeJS applications

## v5.10.12
NODE-4669: Enable TF Token for Updates on ValidateInternals 

## v5.10.10
NODE-4509: update logs to relative path

## v5.10.9
* Update module name to include version to fit in powersearch structure

## v5.10.8
* NODE-4471: Powersearch for NodeJS modules

## v5.10.5 - 5.10.7
* NODE-4471: Powersearch for NodeJS modules testing

## v5.10.4
* NODE-4340: security-ebay___WhitelistPerAppname Not Showing Up, https://jirap.corp.ebay.com/browse/NODE-4340

## v5.10.1 - 5.10.3
* Fixed: descriptionLine empty issue

## v5.10.0
* NODE-3084: Added TrustFabric Token Validation for UpdateConfig bean

## v5.9.2
* NODE-3896: OAuth Token in Prod Endpoint Fix(#179)

## v5.9.0
* Typescript support for validate-internals-ebay module, https://jirap.corp.ebay.com/browse/NODE-3688

## v5.8.1
* Update condition check for production & pre prod because the env variable in Node is different than Raptor

## v5.6.2
* Fixed: Seperated metrics content

## v5.6.1
* Fixed: Propagate content-type header for prometheus end point

## v5.6.0
* Updated Prometheus for supporting Exemplers, https://jirap.corp.ebay.com/browse/NODE-3703

## v5.5.2
* Change hostname in CAL link from VI page, https://jirap.corp.ebay.com/browse/NODE-3391

## v5.5.1
* Added: CAL Pool name for building CAL link for container PDLC

## v5.5.0
* Added fire marshal policy component changes, https://jirap.corp.ebay.com/browse/NODE-2679

## v5.4.2
* Decoupled from @ebay/monitor-inc, https://jirap.corp.ebay.com/browse/NODE-3322
## v5.4.0
* Added prometheus namespaces per https://jirap.corp.ebay.com/browse/NODE-3094

## v5.3.2
* Added Envoy Log URLs when Mesh is enabled in ContainerPDLC.
https://jirap.corp.ebay.com/browse/NODE-3102
https://jirap.corp.ebay.com/browse/NODE-3005

## v5.3.1
* Added RBI Version support in VI HomePage (ContainerPDLC), https://jirap.corp.ebay.com/browse/NODE-2977

## v5.3.0
* Added namespace support for prometheus metrics, https://jirap.corp.ebay.com/browse/NODE-2922

## v5.2.9
* Enabled only staging for odbMoName use, https://jirap.corp.ebay.com/browse/NODE-2916

## v5.2.8
* Added odbMoName to CAL link, https://jirap.corp.ebay.com/browse/NODE-2916

## v5.2.7
* NODE-2899: Fix BeatsPackageComponentStatus on container pdlc envoy dashboard
For container pdlc, if enabled e2e tls, BeatsPackageComponentStatus is no longer available. So, show "Not Available" instead as Raptor framework does. 

## v5.2.4
* NODE-2867: Added Envoy Dashboard for Container PDLC
Modified existing Envoy Dashboard for C3 with pool name from nugget name

## v5.2.3
* NODE-2785: Added Perfmon_tm when TRAFFIC_MIRROR env flag is set.

## v5.2.2
* Changes to add Original endpoint to service client status

## v5.2.2
* NODE-2785: Added Perfmon_tm when TRAFFIC_MIRROR env flag is set.

## v5.2.1
* NODE-2746 Identify Container VM from the VI page

## v5.2.0
* Upgraded to the latest modules in dependnciey list

## v5.1.8
* Added Cookie Audit Instrumentation, https://jirap.corp.ebay.com/browse/NODE-2615

## v5.1.7
* Fixed: VI provides links with ip while cal logs with machine name, https://jirap.corp.ebay.com/browse/NODE-2575

## v5.1.6
* Fixed: Replaced 127.0.0.1 IP check with ip.isLoopBack()

## v5.1.5
* Added: envoy dashboard url supprts environmnent change

## v5.1.4
* Fixed: Exempted ViewConfigCategory from port redirection

## v5.1.3
* Fixed: the envoy dashboard url in ValidateInternals-EnvoyInfo
https://jirap.corp.ebay.com/browse/NODE-2554

## v5.1.2
* Fixed: VI 8083 Redirection not happening when Envoy is enabled
https://jirap.corp.ebay.com/browse/NODE-2557

## v5.1.1
* Fixed: Envoy Server parsing error for new version.
https://jirap.corp.ebay.com/browse/NODE-2551

## v5.1.0
* Split prometheus to `platform` and `application`
https://jirap.corp.ebay.com/browse/NODE-2517

## v5.1.0
* Enabled port redirection from 8080 to 8083 for ValidateInternals
* Disbaled port redirection for DEV & Test env, also if request is from 127.0.0.1(i.e side cars/agents)
https://jirap.corp.ebay.com/browse/NODE-2472
https://jirap.corp.ebay.com/browse/NODE-2469
https://jirap.corp.ebay.com/browse/NODE-2481

## v5.0.0
* Removed dependency on `v8-profiler-node8`. Node v8.x apps will have to explicitly add in in `package.json` 
* Added security fix for config bean update operations

## v4.7.1
* Fetched `tlsVersion` for Service Client Status table from corresponding configbean.

## v4.7.0
* Added native CPU and Heap profilers

## v4.6.4
* Fixed Envoy Configuration as per Raptor for Envoy Certs
* Added BeatsPackageComponentStatus component status

## v4.7.0
* Added native profiling of CPU (node 8) and Heap memory (node 10), https://jirap.corp.ebay.com/browse/NODE-2057.

## v4.6.3
* Added Service Id to service-client status table
* Fixed broken link for config-bean (regression due to 4.6.1)

## v4.6.2
* Added flag for enabled/disable prometheus URL

## v4.6.1
* Added Envoy Tab in ValidateInternals Page and Envoy Logo if Envoy is enabled.
* Updated Troubleshooting tab with green color and moved to first
* UI changes for service-client-status table; corresponding [JIRA.](https://jirap.corp.ebay.com/browse/NODE-2137)

## v4.6.0
* Prometheous endpoint change `/admin/v3console/prometheus` -> `/admin/prometheus`
* Updated troubleshooting page per config-bean-ebay changes https://github.corp.ebay.com/nodejs/config-bean-ebay/commit/c04a168f718bccb935ad1d40040f2acfb7197f5d
   * Added formatting of the values to fit the page

## v4.5.0
* Added Endpoint & DiscoveredEndpoint in Service Client Status component

## v4.4.0
* Exposed service-discovery json & modules by adding them to VI menu

## v4.3.0
* Exposed prometheus metrics url on admin, path `/admin/v3console/prometheus`

## v4.2.8
* Moved express to dependencies from devDependencies as VI relies on it.

## v4.2.7
* Fixed bug for duplicate express dependency and added console log for VI allowUpdate

## v4.2.6
* Fixed: Added proper error message when VI proxy call fails
https://jirap.corp.ebay.com/browse/NODE-1832

## v4.2.5
* Fixed: Removed local scm per performance improvements on server startup
* Fixed: Added X-EBAY-FORCE-VI-PORT-REDIRECTION for 8083 redirection https://jirap.corp.ebay.com/browse/NODE-1851

## v4.2.4
* Added component "PaaS Metadata Context", which displays configuration present in `.metadata.json` file on instance

## v4.2.3
* Switched v8-profiler for Node 10.x

## v4.2.2
* Added envoy & nodeagent logs when present to Log Files

## v4.2.1
* Fixed: Altus `executeUrl` not working when envoy is present

## v4.2.0
* Support customized component status for global config in validate-internals-ebay, https://jirap.corp.ebay.com/browse/NODE-1794

## v4.1.5
* Fixed: VI now listens & stop listening on port only when parentApp does so. 
https://jirap.corp.ebay.com/browse/NODE-1790

## v4.1.4
* Fixed: IP Address in VI page shows machine IP instead of client IP
https://jirap.corp.ebay.com/browse/NODE-1789

## v4.1.3
* VI now listens on random port in NODE_ENV=test, unless process.env.VIPORT is specified
https://jirap.corp.ebay.com/browse/NODE-1782?filter=129660 

## v4.1.2
* Fixed VI redefining the redirection bean if already defined. Added redirection port env variable instead of redirecting to 8083 always.
https://jirap.corp.ebay.com/browse/NODE-1756

## v4.1.1
* Fixed: VI Should not allow update when `x-client-ip` has multiple IP as this is set only by envoy.
https://jirap.corp.ebay.com/browse/NODE-1765

## v4.1.0
* Added feature to render `type:timestamp` attribute of a config bean as formatted date
* Added feature to edit `type:boolean` attribute of a config bean through pre-filled dropdown instead of textbox 

## v4.0.6
* Added Envoy related Component status & config bean
* Added Envoy EnvoyServerInfoComponentStatus 
* Added Envoy EnvoyHealthComponentStatus 
* Added Envoy nodejs.config.EnvoyLoggingConfigBean Config bean 

## v4.0.5
* Added changes for running ValidateInternals in dedicated 8083 Port with config bean to enabled redirection from 8080 to 8083
* Added: Allow ECV  Check on 8080/8082, do not redirect ECV

## v4.0.4
* Upgrade v8-profiler to pickup node8 segfault fix when doing heap dumps
* Corrected worker detection to work in node8

## v4.0.3
* Added hystrix-dashboard
* Added server status per https://github.corp.ebay.com/nodejs/validate-internals-ebay/issues/75

## v4.0.2
* Added Service Status List on Component List

## v4.0.1
* Add missing connection tester package.

## v4.0.0
* Remove peer and unwanted dependencies and upgrade dependencies

## v0.0.69
* Should not fail when a worker port for an inter-worker communication is taken
* Added rounding of CPU usage

## v0.0.68
* Fixed segmentation fault at the end of heap dump with latest v8-profiler
* Mapped errorCount from stats.esp to stats.errorCount sent to PerfMon CAL channel

## v0.0.67
* Added `VPC` & `PaaSRealm` information in Validate Internals
* Added troubleshooting page

## v0.0.66
* Added security related metrics (`xss`, `csrf`, `redirection` etc) to log to Sherlock

## v0.0.65
* Added an pi to return host list of dependency services

## v0.0.64
* Added `x-ebay-akamai-9`  header check for `allowView` & `allowUpdate` to protect from IP address hack.

## v0.0.63
* Fixed missing attributes like `Environment` in XSL

## v0.0.62
* Picking up the latest version of xapth

## v0.0.61
* Added: Escaping html data to display appmeta in component status

## v0.0.60
* Corrected host information component name for SEC tool to fetch it correctly

## v0.0.59
* Added Feature to reset `ebay.kernel.ServeTraffic` bean value to `TrafficEnabled` on startup.

## v0.0.58
* Added CAL HeartBeat for Server Restart event
* Fixed: errors per second metrics should be rounded https://jirap.corp.ebay.com/browse/NODE-475 and https://github.corp.ebay.com/nodejs/validate-internals-ebay/issues/43
* Exposed: vi app for brogan to hook up to
* Removed: explicit express dependency
* Added: 'EAR Re-start time at' for SEC integration
* Added: xpath support, example:
```
/admin/v3console/ValidateInternals2?component=hostinformation&forceXml=true&xpath=ValidateInternals/Component%5B@name=%27Host%20Information%27%5D/Properties/Property%5B@name=%27Container%27
```

## v0.0.57
* Some images were missing after the last publish. Re-publishing to make sure they are there.

## v0.0.56
* Security Issue Fixed: Should not read file other than `logs` folder
* e.g Should fail to load this url http://phx5qa01c-a9ba.stratus.phx.qa.ebay.com:8080/admin/v3console/logs?logfile=../index.js
* Switched to `@ebay/utils-ebay` `getRemoteAddr()` instead of custom method.

## v0.0.55
* Added protection against running more than one CPU profiling that could crash the worker.

## v0.0.54
* Removed unused dependencies

## v0.0.53
* accepting integers for markup/markdown
* removing 'usage' dep and removing 'heapdump', instead using 'v8-profiler'

## v0.0.52
* Adding functionality to get dependency tree as part of VI

## v0.0.51
* Fixed XSLT parse errors in Firefox and Chrome browsers

## v0.0.50
* VI UI changes for CPU and Memory profiling

## v0.0.49
* Changed SERVICE_STATUS to SVC_CHANNEL_STATUS

## v0.0.48
* Added flame charts to heap dump page

## v0.0.47
* Removed dependency on commons-ebay to fix circular dependency problem.

## v0.0.43 - v0.0.46
* Moved vague peerDependencies to dev dependency to avoid breaking peerDependencies

## v0.0.42
* Added `HeapDump` &  `CpuProfile` in ValidateInternals page.
* Added 2 new urls in VI page `/admin/v3console/heapdump` & `/admin/v3console/cpuprofile`

## v0.0.41
* Node 4.0 - Upgraded `usage` & `npm` versions

## v0.0.40
* Enhancement : Allowed `update config data` to work on `HTTP POST`

## v0.0.39
* Added `Environment` for `NODE_ENV` as part of ValidateInternals page

## v0.0.38
* Switched environment-inc to environment-ebay

## v0.0.37
* update syntax for res.send(body, status)

## v0.0.36
* Fixed: TPS and Transaction time are not showing in CAL

## v0.0.35
* Fixed: Rendering `ThreadResource` XSL rendering. [JIRA](https://jirap.corp.ebay.com/browse/XOAPP-12335)

## v0.0.34
* Fixed: should not allow changing prod VI from non-RC boxes

## v0.0.33
* Moved hostip-checker-ebay to peerDependency

## v0.0.32
* Fixed bug for showing BuildId in ValidateInternals page (POLYGLOT-1218)
