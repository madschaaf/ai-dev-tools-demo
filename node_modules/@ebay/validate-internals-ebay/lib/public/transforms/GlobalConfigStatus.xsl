<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="html"/>
  <xsl:include href='PageLayout.xsl'/>

  <xsl:template match="/">
    <xsl:call-template name='page-layout'>
      <xsl:with-param name='root-node' select="ValidateInternals"/>
      <xsl:with-param name='title-text' select="'Administration Console'"/>
    </xsl:call-template>
  </xsl:template>

  <xsl:template name='page-content'>
    <xsl:if test="count(ValidateInternals/Component) > 1">
      <div class="page_nav_wrapper">
        <div class="page_nav"><div>Go to</div>
          <ul>
            <xsl:apply-templates select="ValidateInternals/Component" mode="page_navigation" />
          </ul>
        </div>
      </div>
    </xsl:if>
    <xsl:apply-templates select="ValidateInternals/Component"/>
  </xsl:template>

  <xsl:template match="Component[contains(@name, 'Global Config Status')]">
    <div id='GlobalConfigStatusTable_title' class="table_title">Global Config Status</div>
    <style>
      tr.gc_warning_0 td {
        background:linear-gradient(#aa0000,#ff0000);color:white
      }
      tr.gc_warning_1 td {
        background:linear-gradient(#ffffaa,#ff2222)
      }
      tr.gc_warning_2 td {
        background:linear-gradient(#ffffaa,#ffffcc)
      }
      tr.gc_warning_3 td {
        background:linear-gradient(#aaffaa,#aaffcc)
      }
    </style>
    <table id="GlobalConfigStatusTable" class="display componentTable">
      <thead>
        <tr>
          <th class="left" style="width: 20%">Property</th>
          <th class="left" style="width: 80%">Value</th>
          <th class="left" style="width: 20%">Status</th>
        </tr>
      </thead>
      <tbody>
        <xsl:apply-templates select="Properties/Property[@name='Config Manifest']" />
      </tbody>
    </table>
    <br />
    <br />
    <div id='GlobalConfigDetailTable_title' class="table_title">Global Config Source</div>
    <table id="GlobalConfigDetailTable" class="display componentTable">
      <thead>
        <tr>
          <th class="left" style="width: 150px">Project</th>
          <th class="left" style="width: 150px">Schema Version</th>
          <th class="left" style="width: 150px">Config</th>
          <th class="left" style="width: 50px">Target</th>
          <th class="left">Location</th>
          <th class="left" style="width: 50px">Status</th>
        </tr>
      </thead>
      <tbody>
        <xsl:apply-templates select="Properties/Property[@name!='Config Manifest']" />
      </tbody>
    </table>
  </xsl:template>
  <xsl:template match="Properties/Property[@name='Config Manifest']">
    <tr>
      <xsl:if test="@warningLevel">
        <xsl:attribute name="class">
          <xsl:call-template name="WarningStyle">
            <xsl:with-param name="level" select="@warningLevel" />
          </xsl:call-template>
        </xsl:attribute>
      </xsl:if>
      <td><xsl:value-of select="@name" /></td>
      <td><xsl:value-of select="." /></td>
      <td><xsl:value-of select="@status" /></td>
    </tr>
  </xsl:template>
  <xsl:template match="Properties/Property[@name!='Config Manifest']">
    <tr>
      <xsl:if test="@warningLevel">
        <xsl:attribute name="class">
          <xsl:call-template name="WarningStyle">
            <xsl:with-param name="level" select="@warningLevel" />
          </xsl:call-template>
        </xsl:attribute>
      </xsl:if>
      <td><xsl:value-of select="@name" /></td>
      <td><xsl:value-of select="@version" /></td>
      <td><xsl:value-of select="@config" /></td>
      <td><xsl:value-of select="@target" /></td>
      <td><xsl:value-of select="." /></td>
      <td><xsl:value-of select="@status" /></td>
    </tr>
  </xsl:template>

  <xsl:template name="WarningStyle">
    <xsl:param name="level" />
    <xsl:choose>
      <xsl:when test="$level &lt; 1">gc_warning_0</xsl:when>
      <xsl:when test="$level &lt; 2">gc_warning_1</xsl:when>
      <xsl:when test="$level &lt; 3">gc_warning_2</xsl:when>
      <xsl:when test="$level &lt; 4">gc_warning_3</xsl:when>
      <xsl:otherwise><xsl:text> </xsl:text></xsl:otherwise>
    </xsl:choose>
  </xsl:template>
  <!--******************************************************
  ** "Component" template used for components that
  ** have name-value pair properties
  ***************************************************-->


</xsl:stylesheet>
