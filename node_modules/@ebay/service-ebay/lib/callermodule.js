'use strict';

const Path = require('path'),
    Fs = require('fs'),
    caller = require('caller');

module.exports = function callermodule() {
    return lookup(Path.dirname(caller(2)));
};

function lookup(dir) {
    const file = Path.join(dir, 'package.json');

    if (Fs.existsSync(file)) {
        const pkg = require(file);

        return {
            name: pkg.name,
            version: pkg.version,
            description: pkg.description,
            repository: typeof pkg.repository === 'object' ? pkg.repository.url : pkg.repository,
            location: file
        };
    }

    const parent = Path.dirname(dir);

    if (parent !== dir) {
        return lookup(parent);
    }

    return undefined;
}
