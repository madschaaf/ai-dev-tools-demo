'use strict';

var hmvUtils = require('../header-multi-value'),
    CONST = {
        USER_ID: 'origUserName',
        ACCOUNT_ID: 'origAcctId',
        RECOGNIZED: 'recognized'
    };

function OriginalUserId(multiValue, req) {
    var value = hmvUtils.parse(multiValue, false, true);

    this.userId = value.get(CONST.USER_ID);
    this.accountId = value.get(CONST.ACCOUNT_ID);
    var recognized = value.get(CONST.RECOGNIZED);
    this.recognized = recognized === 'true';

    this.req = req;
}

OriginalUserId.prototype = {
    buildHeader: function() {
        var headerVal = hmvUtils.create();
        headerVal.set(CONST.USER_ID, this.userId);
        headerVal.set(CONST.ACCOUNT_ID, this.accountId);
        headerVal.set(CONST.RECOGNIZED, !!this.recognized);
        return headerVal.toString();
    }
};

module.exports.OriginalUserId = OriginalUserId;

module.exports.create = function(multiValue, req) {
    return new OriginalUserId(multiValue, req);
};
