/*global window: false ebay:false*/
'use strict';

function SPTag(context, moduleId, linkId) {
    if (!context) {
        throw new Error('context is required argument in spTag');
    }
    this._moduleId = moduleId;
    this._linkId = linkId;
}

SPTag.prototype = {
    moduleId: function (moduleId) {
        this._moduleId = moduleId;
        return this;
    },
    linkId: function (linkId) {
        this._linkId = linkId;
        return this;
    },
    toString: function () {
        return generateSPTagValue(window.$ebay.tracking.pageId, this._moduleId, this._linkId);
    }
};

exports.spTag = function(context, moduleId, linkId) {
    return new SPTag(context, moduleId, linkId);
};

function generateSPTagValue(pageId, moduleId, linkId) {
    var id = [];
    id.push('p' + pageId);
    if (moduleId) {
        id.push('m' + moduleId);
    }
    if (linkId) {
        id.push('l' + linkId);
    }
    return id.join('.');
}