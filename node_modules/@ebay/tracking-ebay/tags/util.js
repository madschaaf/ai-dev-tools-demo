'use strict';

var ok = require('assert').ok;

function getRequest(context) {
    return context.stream && context.stream.req || context.global && context.global.req;
}

function SPTag(context, moduleId, linkId) {
    ok(context, 'context is required argument in spTag');
    this.req = getRequest(context);
    this._moduleId = moduleId;
    this._linkId = linkId;
}

SPTag.prototype = {
    moduleId: function (moduleId) {
        this._moduleId = moduleId;
        return this;
    },
    linkId: function (linkId) {
        this._linkId = linkId;
        return this;
    },
    toString: function () {
        return this.req.ebay.tracking.getSPTagValue(this._moduleId, this._linkId);
    }
};

exports.getRequest = getRequest;

exports.spTag = function(context, moduleId, linkId) {
    return new SPTag(context, moduleId, linkId);
};
