'use strict';

const TLS_VERSIONS = {
    '2': 'SSLv2',
    '768': 'SSLv3',
    '769': 'TLSv1',
    '770': 'TLSv1.1',
    '771': 'TLSv1.2',
    '772': 'TLSv1.3'
};

module.exports.parseClientTLSVersionHeader = req => {
    const headerValue = req.headers && req.headers['x-ebay-client-tls-version'];
    const [version, ip] = headerValue && headerValue.split(',').map(str => str.trim()) || [];
    
    return {
        version: version && TLS_VERSIONS[version] || version,
        ip
    };
};
