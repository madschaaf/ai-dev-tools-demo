import { Request } from 'express';

// Request Utils
export function getRemoteAddr(req: Request, trustedOnly?: boolean): string | undefined;
export function getRemoteAddrFromTrustedHeader(req: Request): string | undefined;
export function getClientIP(req: Request): string | undefined;
export function getServerName(req: Request): string;
export function isIPFromAkamaiHeader(req: Request): boolean;
export function getStaticUrl(req: Request, relativePath: string, secure?: boolean): string;
export function getClientInfo(req: Request, maskedPayload: string): string;
export function getIpAddress(): string | undefined;

// TLS Utils
export type TLSVersion = 'SSLv2' | 'SSLv3' | 'TLSv1' | 'TLSv1.1' | 'TLSv1.2' | 'TLSv1.3';

export interface TLSVersionInfo {
    version: TLSVersion | string | undefined;
    ip: string | undefined;
}

export function parseClientTLSVersionHeader(req: Request): TLSVersionInfo;

// GUID Generator
export interface GUIDParseResult {
    date: Date;
    ip: string;
    hash: number;
    counter: number;
}

export class GUIDGenerator {
    constructor();
    readonly staticGUID: string;
    readonly staticPaddedGUID: string;
    readonly staticISOGUID: string;
    readonly counter: number;
    
    nextCounter(): number;
    nextGUID(): string;
    nextPaddedGUID(): string;
    nextISOGUID(): string;
    parseGUID(guid: string): GUIDParseResult | null;
    parsePaddedGUID(guid: string): GUIDParseResult | null;
    parseISOGUID(guid: string): GUIDParseResult | null;
}

// RlogId Generator
export interface RlogIdGenerator {
    generate(req: Request): string;
    getMachineName(poolName: string, hostname: string): string;
}

export const RlogIdGenerator: RlogIdGenerator;
