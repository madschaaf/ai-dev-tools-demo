import * as testingCommon from "./common";

/**
 * Create i18n bundle loading support for using i18n in tests.
 * Setup creates a vi method, `vi.preloadI18nBundles`, which
 * should be called before the test suite runs to preload all
 * or the specified i18n bundles.
 * @returns {{ contentManager: ContentManager }}
 */
export const setup = async () => {
    /**
     * @warn dyn import use for improved node.js + vitest module compat.
     */
    const { vi } = await import("vitest");
    const contentManager = await testingCommon.bindGlobalContentManager();
    vi.preloadI18nBundles = testingCommon.createI18NBundlePreloader({
        contentManager,
    });
    return { contentManager };
};
