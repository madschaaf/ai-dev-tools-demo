'use strict';

const Path = require('path');

function selectConfig() {
    if (/pre-production/.test(process.env.NODE_ENV)) {
        return 'pre-production.json';
    }

    if (/sandbox/.test(process.env.NODE_ENV)) {
        return 'sandbox.json';
    }

    if (/stag/.test(process.env.NODE_ENV) || /feature/.test(process.env.NODE_ENV) || /qa/.test(process.env.NODE_ENV) ||
        /dev/.test(process.env.NODE_ENV) || !process.env.NODE_ENV ||
        /lnp/.test(process.env.NODE_ENV)) {
        return 'staging.json';
    }
    return 'config.json';
}

let config;

function getBaseUrl(siteId) {
    config = config || require(Path.resolve(__dirname, '..', 'config', selectConfig()));
    return config.baseUrl[siteId] || config.baseUrl[0];
}

module.exports = {
    getBaseUrl,
    reset() {
        config = undefined;
    }
};
