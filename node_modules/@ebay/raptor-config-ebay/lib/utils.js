'use strict';

var _ = require('underscore');
var configBean = require('@ebay/config-bean-ebay');
var BEAN_ID = 'node.ebay.config.raptor.config';

var buildLoadKey = function (message) {
    return ['domain=', message.domain,
            '&target=', message.target,
            '&project=', message.project,
            '&config=', message.config,
            '&version=', message.version].join('');
};

/**
    Create config bean for raptor config. Used for fetching staged config.
 */
var defineBean = function(opts) {
    opts = opts || {};
    var bean = _.extend({
        'configbean': true,
        'id': BEAN_ID,
        'alias': BEAN_ID,
        'group': 'nodejs.config',
        'desc': 'Raptor Configuration',
        'attributes': [{
            'name': 'Staging',
            'value': false,
            'desc': 'fetch staged config',
            'type': 'boolean',
            'readable': 'true',
            'writable': 'true'
        }]
    }, opts);

    configBean.define(bean);
    return bean;
};


module.exports = {
    buildLoadKey: buildLoadKey,
    defineBean: defineBean,
    configBeanId: BEAN_ID
};